rank(ts_sum((open>close)*(open-close)/(high-low),20)/ts_sum((open<close)*(-(open-close)/(high-low)),20)/
ts_sum((open>close)*(open-close)/(high-low),252)/ts_sum((open<close)*(-(open-close)/(high-low)),252))